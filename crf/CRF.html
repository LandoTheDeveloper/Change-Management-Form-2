<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Change Request Form</title>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js"></script>

</head>
<body>
    <div class="black-bar">
        <a href="https://www.sgstechnologies.net/"><img src="logo.png" alt="SGS Technologies Logo" class="logo" id="logo"></a>
    </div>

    <div class="sidebar">
        <a href="projects.php">All Projects</a>
        
    </div>
    
    <div for="page-content" class="container content">
        <button class="settings-button" onclick="toggleSidebar()">Settings</button>
        <h1>Change Request Form</h1>
        <form id="change-request-form" method="post" enctype="multipart/form-data" action="insertForm.php">
            <h2>General Information</h2>

            <label for="project-name">Project Name:</label>
            <!-- Original select element, kept disabled -->
            <select id="project-name-choice" disabled>
                <option value=""></option>
            </select>
            <!-- Hidden input to store the selected project name -->
            <input type="hidden" id="selected-project-name" name="selected_project_name">

            <script src="dropdown.js"></script>
            <script>
                populateProjectDropdown();
            </script>
            <input type="text" id="project-name" name="project_name" required disabled="disabled">
            <button id="newProject" class="button" onclick="createNewProject()">Create a New Project</button> <br>
            
            <label for="cr-number">CR#:</label>
            <!-- Original input field, kept disabled -->
            <input type="text" id="cr-number" name="cr_number" required disabled>

            <!-- Hidden input to store the selected CR number -->
            <input type="hidden" id="selected-cr-number" name="selected_cr_number">

            

            
            <label for="cr-type">Type of CR:</label>
            <input type="text" id="cr-type" name="cr_type" required><br>
            
            <label for="submitter-name">Submitter Name:</label>
            <input type="text" id="submitter-name" name="submitter_name" required><br>
            
            <label for="date-submitted">Date Submitted:</label>
            <input type="date" id="date-submitted" name="date_submitted" required><br>

            <label for="client-email">Client Email:</label>
            <!-- Original input field, kept disabled -->
            <input type="email" id="client-email" name="client_email" required disabled>

            <!-- Hidden input to store the selected client email -->
            <input type="hidden" id="selected-client-email" name="selected_client_email">
            
            <br>
            <h2>Scope of Work</h2>
            <div id="items-container">
                <!-- Initial item field -->
                <div class="item">
                    <label>Item:</label>
                    <!-- Original textarea, kept hidden -->
                    <textarea id="scope-of-work-editor" name="items[]"></textarea>

                    <!-- Initialize TinyMCE on the original textarea -->
                    <script>
                        tinymce.init({
                            selector: "#scope-of-work-editor",
                        });
                    </script>
                    <label>Hours Assigned:</label>
                    <input type="number" name="hours[]" required>
                </div>
            </div>
            <button type="button" onclick="addItemField()" class="button">Add Item</button>
            <br>
            <h2>Client Acceptance</h2>
            <label>Acceptance:</label>
            <input type="radio" name="acceptance" value="accepted" id="accepted"> Yes
            <input type="radio" name="acceptance" value="not_accepted" id="not_accepted"> No<br>
            
            <div id="accepted_visibility">
                <label for="client-name">Client Name:</label>
                <input type="text" id="client-name" name="client_name"><br> 
                
                <!-- Signature canvas -->
                <label for="client-signature">Client Signature:</label>
                <canvas id="signature-canvas" width="300" height="150" style="border: 1px solid #000;"></canvas><br>
                <button type="button" onclick="clearSignatureCanvas()" class="button">Clear Signature</button><br>
                <input type="hidden" id="signature-data" name="client_signature">
                
                <label for="client-approver-title">Title of Client Approver:</label>
                <input type="text" id="client-approver-title" name="client_approver_title"><br>
                
                <label for="approval-date">Date of Approval:</label>
                <input type="date" id="approval-date" name="approval_date"><br>
            </div>

            <div id="not_accepted_visibility">
                <label for="comments">Comments:</label><br>
                <textarea id="comments" name="comments" placeholder='If "No" is selected, please provide a rationale and description of what is required to attain approval.'></textarea><br>
            </div>
            <button type="submit" class="submit_button">Submit</button>
        </form>
    </div>

    <script src="itemFields.js"></script>
    <script src="canvas.js"></script>
    <script src="rich-text-editor.js"></script>
    <script src="showAcceptance.js"></script>
    <script src="createProject.js"></script>
    <script src="fetchProjectDetails.js"></script>
    <script src="openSettings.js"></script>

</body>
</html>
